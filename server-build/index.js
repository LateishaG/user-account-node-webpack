import * as __WEBPACK_EXTERNAL_MODULE__reduxjs_toolkit_fb094368__ from "@reduxjs/toolkit";
import * as __WEBPACK_EXTERNAL_MODULE__sendgrid_mail_fbccceac__ from "@sendgrid/mail";
import * as __WEBPACK_EXTERNAL_MODULE_axios__ from "axios";
import * as __WEBPACK_EXTERNAL_MODULE_bcryptjs__ from "bcryptjs";
import * as __WEBPACK_EXTERNAL_MODULE_dotenv__ from "dotenv";
import * as __WEBPACK_EXTERNAL_MODULE_express__ from "express";
import * as __WEBPACK_EXTERNAL_MODULE_jsonwebtoken__ from "jsonwebtoken";
import * as __WEBPACK_EXTERNAL_MODULE_react__ from "react";
import * as __WEBPACK_EXTERNAL_MODULE_react_dom_server_ec84c2b9__ from "react-dom/server";
import * as __WEBPACK_EXTERNAL_MODULE_react_redux_87be03b0__ from "react-redux";
import * as __WEBPACK_EXTERNAL_MODULE_react_router_dom_a27720b7__ from "react-router-dom";
import * as __WEBPACK_EXTERNAL_MODULE_react_router_dom_server_js_f6b656a2__ from "react-router-dom/server.js";
import * as __WEBPACK_EXTERNAL_MODULE_sequelize__ from "sequelize";
import * as __WEBPACK_EXTERNAL_MODULE_url__ from "url";
import { createRequire as __WEBPACK_EXTERNAL_createRequire } from "module";
/******/ var __webpack_modules__ = ({

/***/ "@reduxjs/toolkit":
/*!***********************************!*\
  !*** external "@reduxjs/toolkit" ***!
  \***********************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE__reduxjs_toolkit_fb094368__;

/***/ }),

/***/ "@sendgrid/mail":
/*!*********************************!*\
  !*** external "@sendgrid/mail" ***!
  \*********************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE__sendgrid_mail_fbccceac__;

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_axios__;

/***/ }),

/***/ "bcryptjs":
/*!***************************!*\
  !*** external "bcryptjs" ***!
  \***************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_bcryptjs__;

/***/ }),

/***/ "dotenv":
/*!*************************!*\
  !*** external "dotenv" ***!
  \*************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_dotenv__;

/***/ }),

/***/ "express":
/*!**************************!*\
  !*** external "express" ***!
  \**************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_express__;

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_jsonwebtoken__;

/***/ }),

/***/ "react":
/*!************************!*\
  !*** external "react" ***!
  \************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_react__;

/***/ }),

/***/ "react-dom/server":
/*!***********************************!*\
  !*** external "react-dom/server" ***!
  \***********************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_react_dom_server_ec84c2b9__;

/***/ }),

/***/ "react-redux":
/*!******************************!*\
  !*** external "react-redux" ***!
  \******************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_react_redux_87be03b0__;

/***/ }),

/***/ "react-router-dom":
/*!***********************************!*\
  !*** external "react-router-dom" ***!
  \***********************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_react_router_dom_a27720b7__;

/***/ }),

/***/ "react-router-dom/server.js":
/*!*********************************************!*\
  !*** external "react-router-dom/server.js" ***!
  \*********************************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_react_router_dom_server_js_f6b656a2__;

/***/ }),

/***/ "sequelize":
/*!****************************!*\
  !*** external "sequelize" ***!
  \****************************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_sequelize__;

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

var x = y => { var x = {}; __webpack_require__.d(x, y); return x; }
var y = x => () => x
module.exports = __WEBPACK_EXTERNAL_MODULE_url__;

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("fs");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = __WEBPACK_EXTERNAL_createRequire(import.meta.url)("path");

/***/ }),

/***/ "./server/api/auth.js":
/*!****************************!*\
  !*** ./server/api/auth.js ***!
  \****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ "express");
/* harmony import */ var _db_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../db/index.js */ "./server/db/index.js");
/* harmony import */ var _middleware_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./middleware.js */ "./server/api/middleware.js");
/* harmony import */ var _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @sendgrid/mail */ "@sendgrid/mail");
/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! jsonwebtoken */ "jsonwebtoken");
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! path */ "path");

const app = express__WEBPACK_IMPORTED_MODULE_0__["default"].Router();





/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (app);
app.post('/', async (req, res, next) => {
  try {
    res.status(200).send(await _db_index_js__WEBPACK_IMPORTED_MODULE_1__.User.authenticate(req.body));
  } catch (err) {
    next(err);
  }
});
app.post('/register', async (req, res, next) => {
  try {
    const user = await _db_index_js__WEBPACK_IMPORTED_MODULE_1__.User.create(req.body);
    //create email token to use in confirmation url

    const emailToken = jsonwebtoken__WEBPACK_IMPORTED_MODULE_4__["default"].sign({
      id: user.id
    }, process.env.EMAILJWT, {
      expiresIn: '10m'
    });
    const url = `http://localhost:3000/confirmation/${emailToken}`;
    _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__["default"].setApiKey(process.env.SENDGRID_API_KEY);
    const msg = {
      to: user.email,
      // Change to your recipient
      from: process.env.EMAILSENDER,
      // Change to your verified sender
      subject: 'Email Confirmation',
      text: 'please click the confirmation link',
      html: `<p> please click the confirmation link: <a href= "${url}"> ${url} </a></p>` //conformation url
    };

    _sendgrid_mail__WEBPACK_IMPORTED_MODULE_3__["default"].send(msg).then(() => {
      console.log('Email sent');
    }).catch(error => {
      console.error(error);
    });
    res.send(user.generateToken());
  } catch (err) {
    next(err);
  }
});

//add a confirmation route
app.put('/confirmation/email/', async (req, res, next) => {
  try {
    const {
      id
    } = jsonwebtoken__WEBPACK_IMPORTED_MODULE_4__["default"].verify(req.body.token, process.env.EMAILJWT);
    const user = await _db_index_js__WEBPACK_IMPORTED_MODULE_1__.User.findByPk(id);
    if (user.id === id) {
      await user.update({
        emailVerification: true
      });
      res.send({
        verification: 'confirmed'
      });
    } else {
      res.send({
        verification: 'invalid'
      });
    }
  } catch (err) {
    next(err);
  }
});
app.get('/', _middleware_js__WEBPACK_IMPORTED_MODULE_2__["default"], (req, res, next) => {
  try {
    res.send(req.user);
  } catch (err) {
    next(err);
  }
});
app.put('/', _middleware_js__WEBPACK_IMPORTED_MODULE_2__["default"], async (req, res, next) => {
  try {
    const user = req.user;
    //define the properties a user can change
    await user.update(req.body);
    res.send(user);
  } catch (err) {
    next(err);
  }
});

/***/ }),

/***/ "./server/api/middleware.js":
/*!**********************************!*\
  !*** ./server/api/middleware.js ***!
  \**********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _db_index_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../db/index.js */ "./server/db/index.js");

const isLoggedIn = async (req, res, next) => {
  try {
    const user = await _db_index_js__WEBPACK_IMPORTED_MODULE_0__.User.findByToken(req.headers.authorization);
    req.user = user;
    next();
  } catch (err) {
    console.log(err);
    next(err);
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (isLoggedIn);

/***/ }),

/***/ "./server/app.js":
/*!***********************!*\
  !*** ./server/app.js ***!
  \***********************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var express__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! express */ "express");
/* harmony import */ var dotenv__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! dotenv */ "dotenv");
/* harmony import */ var path__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! path */ "path");
/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! fs */ "fs");
/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! url */ "url");
/* harmony import */ var _api_auth_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./api/auth.js */ "./server/api/auth.js");
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_dom_server__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! react-dom/server */ "react-dom/server");
/* harmony import */ var react_router_dom_server_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! react-router-dom/server.js */ "react-router-dom/server.js");
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! react-redux */ "react-redux");
/* harmony import */ var _src_Components_App_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../src/Components/App.js */ "./src/Components/App.js");
/* harmony import */ var _src_store__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../src/store */ "./src/store/index.js");

const app = (0,express__WEBPACK_IMPORTED_MODULE_0__["default"])();

dotenv__WEBPACK_IMPORTED_MODULE_1__.config();




//import confirmationRouter from './confirmation.js';







const __dirname = url__WEBPACK_IMPORTED_MODULE_4__["default"].fileURLToPath(path__WEBPACK_IMPORTED_MODULE_2__.normalize("file:///Users/frogstern/sandbox/user-account-node-webpack/server/app.js" + '/..'));
app.use(express__WEBPACK_IMPORTED_MODULE_0__["default"].json({
  limit: '50mb'
}));
app.use('/dist', express__WEBPACK_IMPORTED_MODULE_0__["default"]["static"](path__WEBPACK_IMPORTED_MODULE_2__.join(__dirname, '../dist')));
app.use('/api/auth', _api_auth_js__WEBPACK_IMPORTED_MODULE_5__["default"]);
//app.use('/confirmation', confirmationRouter);

app.get('*', (req, res) => {
  //res.sendFile(path.join(__dirname, '../static/index.html'));
  console.log(req.url);
  const clientApp = react_dom_server__WEBPACK_IMPORTED_MODULE_7__["default"].renderToString( /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__["default"].createElement(react_redux__WEBPACK_IMPORTED_MODULE_9__.Provider, {
    store: _src_store__WEBPACK_IMPORTED_MODULE_11__["default"]
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__["default"].createElement(react_router_dom_server_js__WEBPACK_IMPORTED_MODULE_8__.StaticRouter, {
    location: req.url
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_6__["default"].createElement(_src_Components_App_js__WEBPACK_IMPORTED_MODULE_10__["default"], null))));
  const indexFile = path__WEBPACK_IMPORTED_MODULE_2__.resolve('./static/index.html');
  fs__WEBPACK_IMPORTED_MODULE_3__.readFile(indexFile, 'utf8', (err, data) => {
    if (err) {
      console.error('Something went wrong:', err);
      return res.status(500).send('Oops, better luck next time!');
    }
    return res.send(data.replace('<div id="root"></div>', `<div id="root">${clientApp}</div>`));
  });
});
app.use((err, req, res, next) => {
  console.log(err);
  next(err);
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (app);

/***/ }),

/***/ "./server/db/User.js":
/*!***************************!*\
  !*** ./server/db/User.js ***!
  \***************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _conn_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./conn.js */ "./server/db/conn.js");
/* harmony import */ var bcryptjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcryptjs */ "bcryptjs");
/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ "jsonwebtoken");

const {
  UUID,
  UUIDV4,
  STRING,
  BOOLEAN
} = _conn_js__WEBPACK_IMPORTED_MODULE_0__["default"].Sequelize;


const JWT = process.env.JWT;
const User = _conn_js__WEBPACK_IMPORTED_MODULE_0__["default"].define('user', {
  id: {
    type: UUID,
    primaryKey: true,
    defaultValue: UUIDV4
  },
  email: {
    type: STRING,
    allowNull: false,
    validate: {
      notEmpty: true,
      isEmail: true
    }
  },
  username: {
    type: STRING,
    allowNull: false,
    unique: true,
    validate: {
      notEmpty: true
    }
  },
  password: {
    type: STRING,
    allowNull: false,
    validate: {
      notEmpty: true
    }
  },
  emailVerification: {
    type: BOOLEAN,
    allowNull: false,
    defaultValue: false
  }
});
User.addHook('beforeSave', async user => {
  if (user.changed('password')) {
    user.password = await bcryptjs__WEBPACK_IMPORTED_MODULE_1__["default"].hash(user.password, 10);
  }
});
User.authenticate = async function ({
  username,
  password
}) {
  const user = await this.findOne({
    where: {
      username
    }
  });
  if (user && (await bcryptjs__WEBPACK_IMPORTED_MODULE_1__["default"].compare(password, user.password))) {
    return user.generateToken();
  }
  const error = new Error('bad credentials');
  error.status = 401;
  throw error;
};
User.prototype.generateToken = function () {
  return jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__["default"].sign({
    id: this.id
  }, JWT, {
    expiresIn: '1d'
  });
};
User.findByToken = async function (token) {
  try {
    const {
      id
    } = jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__["default"].verify(token, process.env.JWT);
    const user = await this.findByPk(id);
    if (user) {
      return user;
    }
    throw 'user not found';
  } catch (err) {
    const error = new Error('bad credentials');
    error.status = 401;
    throw error;
  }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (User);

/***/ }),

/***/ "./server/db/conn.js":
/*!***************************!*\
  !*** ./server/db/conn.js ***!
  \***************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var sequelize__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! sequelize */ "sequelize");

const config = {
  dialect: 'postgres',
  host: process.env.HOST || 'localhost'
};
if (process.env.QUIET) {
  config.logging = false;
}
const conn = new sequelize__WEBPACK_IMPORTED_MODULE_0__["default"](process.env.DATABASE_NAME || 'acme_db', process.env.USERNAME || null, process.env.PASSWORD || null, config);
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (conn);

/***/ }),

/***/ "./server/db/index.js":
/*!****************************!*\
  !*** ./server/db/index.js ***!
  \****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   User: () => (/* reexport safe */ _User_js__WEBPACK_IMPORTED_MODULE_1__["default"]),
/* harmony export */   syncAndSeed: () => (/* binding */ syncAndSeed)
/* harmony export */ });
/* harmony import */ var _conn_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./conn.js */ "./server/db/conn.js");
/* harmony import */ var _User_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./User.js */ "./server/db/User.js");


const syncAndSeed = async () => {
  await _conn_js__WEBPACK_IMPORTED_MODULE_0__["default"].sync({
    force: true
  });
  const moe = await _User_js__WEBPACK_IMPORTED_MODULE_1__["default"].create({
    username: 'moe',
    password: '123',
    email: 'test@example.com',
    emailVerification: true
  });
  const lucy = await _User_js__WEBPACK_IMPORTED_MODULE_1__["default"].create({
    username: 'lucy',
    password: '123',
    email: 'test@example.com',
    emailVerification: true
  });
  const larry = await _User_js__WEBPACK_IMPORTED_MODULE_1__["default"].create({
    username: 'larry',
    password: '123',
    email: 'test@example.com',
    emailVerification: true
  });
  const ethyl = await _User_js__WEBPACK_IMPORTED_MODULE_1__["default"].create({
    username: 'ethyl',
    password: '123',
    email: 'test@example.com',
    emailVerification: true
  });
  return {
    users: {
      moe,
      lucy,
      larry,
      ethyl
    }
  };
};


/***/ }),

/***/ "./src/Components/App.js":
/*!*******************************!*\
  !*** ./src/Components/App.js ***!
  \*******************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "react-redux");
/* harmony import */ var _Home__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./Home */ "./src/Components/Home.js");
/* harmony import */ var _Login__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./Login */ "./src/Components/Login.js");
/* harmony import */ var _Profile__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./Profile */ "./src/Components/Profile.js");
/* harmony import */ var _Confirmation__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./Confirmation */ "./src/Components/Confirmation.js");
/* harmony import */ var _CreateAccount__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./CreateAccount */ "./src/Components/CreateAccount.js");
/* harmony import */ var _store_authSlice__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../store/authSlice */ "./src/store/authSlice.js");









const App = () => {
  const dispatch = (0,react_redux__WEBPACK_IMPORTED_MODULE_2__.useDispatch)();
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    dispatch((0,_store_authSlice__WEBPACK_IMPORTED_MODULE_8__.loginWithToken)());
  }, []);

  //todo: have logout/ no auth remove access to certain pages, also add visual for login/logout status

  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, "Acme Test"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Routes, null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Route, {
    path: "/",
    element: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Home__WEBPACK_IMPORTED_MODULE_3__["default"], null)
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Route, {
    path: "/login",
    element: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Login__WEBPACK_IMPORTED_MODULE_4__["default"], null)
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Route, {
    path: "/createaccount",
    element: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_CreateAccount__WEBPACK_IMPORTED_MODULE_7__["default"], null)
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Route, {
    path: "/profile",
    element: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Profile__WEBPACK_IMPORTED_MODULE_5__["default"], null)
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Route, {
    path: "/confirmation/:emailToken",
    element: /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(_Confirmation__WEBPACK_IMPORTED_MODULE_6__["default"], null)
  })));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (App);

/***/ }),

/***/ "./src/Components/Confirmation.js":
/*!****************************************!*\
  !*** ./src/Components/Confirmation.js ***!
  \****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");
/* harmony import */ var _store_authSlice__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../store/authSlice */ "./src/store/authSlice.js");



const Confirmation = () => {
  const {
    emailToken
  } = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_1__.useParams)();
  const navigate = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_1__.useNavigate)();
  const [result, setResult] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({
    verification: 'loading'
  });
  (0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)(() => {
    const sendConfirmation = async () => {
      setResult(await (0,_store_authSlice__WEBPACK_IMPORTED_MODULE_2__.updateConfirmation)(emailToken));
    };
    sendConfirmation();
  }, []);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, `Confirmation Status: ${result.verification}`));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Confirmation);

/***/ }),

/***/ "./src/Components/CreateAccount.js":
/*!*****************************************!*\
  !*** ./src/Components/CreateAccount.js ***!
  \*****************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "react-redux");
/* harmony import */ var _store_authSlice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../store/authSlice */ "./src/store/authSlice.js");




const CreateAccount = () => {
  const [credentials, setCredentials] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({
    email: '',
    username: '',
    password: ''
  });
  const dispatch = (0,react_redux__WEBPACK_IMPORTED_MODULE_2__.useDispatch)();
  const navigate = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_1__.useNavigate)();
  const onChange = ev => {
    setCredentials({
      ...credentials,
      [ev.target.name]: ev.target.value
    });
  };
  const create = ev => {
    ev.preventDefault();
    dispatch((0,_store_authSlice__WEBPACK_IMPORTED_MODULE_3__.register)(credentials));
    navigate('/');
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, "Create Account"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    onClick: () => navigate('/login')
  }, "Login"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Link, {
    to: "/"
  }, "Home"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", {
    onSubmit: create
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    htmlFor: "email"
  }, "Email: "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    id: "email",
    name: "email",
    value: credentials.email,
    onChange: onChange
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    htmlFor: "usr"
  }, "Username: "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    id: "usr",
    name: "username",
    value: credentials.username,
    onChange: onChange
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    htmlFor: "pas"
  }, "Password: "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    id: "pas",
    name: "password",
    value: credentials.password,
    onChange: onChange
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", null, "Submit")));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (CreateAccount);

/***/ }),

/***/ "./src/Components/Home.js":
/*!********************************!*\
  !*** ./src/Components/Home.js ***!
  \********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "react-redux");



const Home = () => {
  const authInfo = (0,react_redux__WEBPACK_IMPORTED_MODULE_2__.useSelector)(state => state.auth.info);
  console.log(authInfo);
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, " Welcome "), authInfo.id ? /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Link, {
    to: "/profile"
  }, "Profile") : /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Link, {
    to: "/login"
  }, "Login"));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Home);

/***/ }),

/***/ "./src/Components/Login.js":
/*!*********************************!*\
  !*** ./src/Components/Login.js ***!
  \*********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");
/* harmony import */ var react_redux__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! react-redux */ "react-redux");
/* harmony import */ var _store_authSlice__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../store/authSlice */ "./src/store/authSlice.js");




const Login = () => {
  const [credentials, setCredentials] = (0,react__WEBPACK_IMPORTED_MODULE_0__.useState)({
    username: '',
    password: ''
  });
  const dispatch = (0,react_redux__WEBPACK_IMPORTED_MODULE_2__.useDispatch)();
  const navigate = (0,react_router_dom__WEBPACK_IMPORTED_MODULE_1__.useNavigate)();
  const onChange = ev => {
    setCredentials({
      ...credentials,
      [ev.target.name]: ev.target.value
    });
  };
  const login = ev => {
    ev.preventDefault();
    dispatch((0,_store_authSlice__WEBPACK_IMPORTED_MODULE_3__.attemptLogin)(credentials));
    navigate('/');
  };
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, "Login"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", {
    onClick: () => navigate('/createaccount')
  }, "Create Account"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Link, {
    to: "/"
  }, "Home"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("form", {
    onSubmit: login
  }, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    htmlFor: "usr"
  }, "Username: "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    id: "usr",
    name: "username",
    value: credentials.username,
    onChange: onChange
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("label", {
    htmlFor: "pas"
  }, "Password: "), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("input", {
    id: "pas",
    name: "password",
    value: credentials.password,
    onChange: onChange
  }), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("button", null, "Submit")));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Login);

/***/ }),

/***/ "./src/Components/Profile.js":
/*!***********************************!*\
  !*** ./src/Components/Profile.js ***!
  \***********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! react */ "react");
/* harmony import */ var react_router_dom__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react-router-dom */ "react-router-dom");


const Profile = () => {
  return /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("div", null, /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement("h1", null, "Profile"), /*#__PURE__*/react__WEBPACK_IMPORTED_MODULE_0__["default"].createElement(react_router_dom__WEBPACK_IMPORTED_MODULE_1__.Link, {
    to: "/"
  }, "Home"));
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (Profile);

/***/ }),

/***/ "./src/store/authSlice.js":
/*!********************************!*\
  !*** ./src/store/authSlice.js ***!
  \********************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   attemptLogin: () => (/* binding */ attemptLogin),
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__),
/* harmony export */   loginWithToken: () => (/* binding */ loginWithToken),
/* harmony export */   logout: () => (/* binding */ logout),
/* harmony export */   register: () => (/* binding */ register),
/* harmony export */   updateConfirmation: () => (/* binding */ updateConfirmation)
/* harmony export */ });
/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ "axios");
/* harmony import */ var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @reduxjs/toolkit */ "@reduxjs/toolkit");


const authSlice = (0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_1__.createSlice)({
  name: 'auth',
  initialState: {
    info: {}
  },
  reducers: {
    setAuth: (state, action) => {
      state.info = action.payload;
    }
  }
});
const {
  setAuth
} = authSlice.actions;
const logout = dispatch => {
  window.localStorage.removeItem('token');
  dispatch(setAuth({}));
};
const loginWithToken = () => async dispatch => {
  const token = window.localStorage.getItem('token');
  if (token) {
    const response = await axios__WEBPACK_IMPORTED_MODULE_0__["default"].get('/api/auth', {
      headers: {
        authorization: token
      }
    });
    dispatch(setAuth(response.data));
  }
};
const attemptLogin = credentials => async dispatch => {
  const response = await axios__WEBPACK_IMPORTED_MODULE_0__["default"].post('/api/auth', credentials);
  window.localStorage.setItem('token', response.data);
  dispatch(loginWithToken());
};
const register = credentials => async dispatch => {
  const response = await axios__WEBPACK_IMPORTED_MODULE_0__["default"].post('/api/auth/register', credentials);
  window.localStorage.setItem('token', response.data);
  dispatch(loginWithToken());
};
const updateConfirmation = async emailToken => {
  const response = await axios__WEBPACK_IMPORTED_MODULE_0__["default"].put('/api/auth/confirmation/email', {
    token: emailToken
  });
  return response.data;
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (authSlice.reducer);

/***/ }),

/***/ "./src/store/index.js":
/*!****************************!*\
  !*** ./src/store/index.js ***!
  \****************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (__WEBPACK_DEFAULT_EXPORT__)
/* harmony export */ });
/* harmony import */ var _reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @reduxjs/toolkit */ "@reduxjs/toolkit");
/* harmony import */ var _authSlice__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./authSlice */ "./src/store/authSlice.js");


const store = (0,_reduxjs_toolkit__WEBPACK_IMPORTED_MODULE_0__.configureStore)({
  reducer: {
    auth: _authSlice__WEBPACK_IMPORTED_MODULE_1__["default"]
  }
});
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (store);

/***/ })

/******/ });
/************************************************************************/
/******/ // The module cache
/******/ var __webpack_module_cache__ = {};
/******/ 
/******/ // The require function
/******/ function __webpack_require__(moduleId) {
/******/ 	// Check if module is in cache
/******/ 	var cachedModule = __webpack_module_cache__[moduleId];
/******/ 	if (cachedModule !== undefined) {
/******/ 		return cachedModule.exports;
/******/ 	}
/******/ 	// Create a new module (and put it into the cache)
/******/ 	var module = __webpack_module_cache__[moduleId] = {
/******/ 		// no module.id needed
/******/ 		// no module.loaded needed
/******/ 		exports: {}
/******/ 	};
/******/ 
/******/ 	// Execute the module function
/******/ 	__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 
/******/ 	// Return the exports of the module
/******/ 	return module.exports;
/******/ }
/******/ 
/************************************************************************/
/******/ /* webpack/runtime/define property getters */
/******/ (() => {
/******/ 	// define getter functions for harmony exports
/******/ 	__webpack_require__.d = (exports, definition) => {
/******/ 		for(var key in definition) {
/******/ 			if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 				Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 			}
/******/ 		}
/******/ 	};
/******/ })();
/******/ 
/******/ /* webpack/runtime/hasOwnProperty shorthand */
/******/ (() => {
/******/ 	__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ })();
/******/ 
/******/ /* webpack/runtime/make namespace object */
/******/ (() => {
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = (exports) => {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/ })();
/******/ 
/************************************************************************/
var __webpack_exports__ = {};
// This entry need to be wrapped in an IIFE because it need to be isolated against other modules in the chunk.
(() => {
/*!*************************!*\
  !*** ./server/index.js ***!
  \*************************/
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _app_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./app.js */ "./server/app.js");
/* harmony import */ var _db_index_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./db/index.js */ "./server/db/index.js");


const init = async () => {
  try {
    if (process.env.SYNC !== 'NO') {
      await (0,_db_index_js__WEBPACK_IMPORTED_MODULE_1__.syncAndSeed)();
    }
    const port = process.env.PORT || 3000;
    const server = _app_js__WEBPACK_IMPORTED_MODULE_0__["default"].listen(port, () => console.log(`listening on port ${port}`));
  } catch (err) {
    console.log(err);
  }
};
init();
})();


//# sourceMappingURL=index.js.map